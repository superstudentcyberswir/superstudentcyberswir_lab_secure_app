name: Perform Mixeway Scan

jobs:
    mixeway-scan:
        name: Mixeway Scanning
        runs-on: ubuntu-latest
        steps:
            - uses: actions/checkout@v1
            - name: Prepare variables
                id: vars
                shell: bash
                run: |
                    echo "##[set-output name=branch;]$(echo ${GITHUB_REF#refs/heads/})"
                    echo "::set-output name=sha_short::$(git rev-parse HEAD)"
            - name: Prepare Mixeway docker image
                run: |
                    docker pull mixeway/scanner:latest
            - name: Run Scan
                run: |
                    docker run -e OSS_USERNAME=chicken-briers-3x@icloud.com -e OSS_KEY=ff3ff6b260ba95aea0749eb82bddc5c00eeddb63 -e MIXEWAY_URL=https://hub.mixeway.io -e MIXEWAY_KEY=03179564-2434-4383-8f51-825e29e9e92b -e MIXEWAY_PROJECT_ID=190 -e MODE=STANDALONE -e MIXEWAY_PROJECT_NAME=superstudentcyberswir_lab_secure_app -e COMMIT_ID=test -e BRANCH=master -v /opt/lab_sec_audit/sast:/opt/sources mixeway/scanner:latest
